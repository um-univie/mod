<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7. Data Formats &#8212; MØD 0.11.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/haxes.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Derivation Graph Strategies" href="../dgStrat/dgStrat.html" />
    <link rel="prev" title="6. EpiM" href="../epim/epim.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-3.4.1.slim.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-4.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>
<nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light  navbar-fixed-top">
	<div class="container">
		<a class="navbar-brand" href="../index.html">
			MØD</a>
		<span class="navbar-text navbar-version pull-left"><b>0.11.0</b></span>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav mr-auto">
				
						<li class="nav-item"><a class="nav-link" href="../genindex.html">Index</a></li>
				
				
					<li class="nav-item dropdown globaltoc-container">
	<a class="nav-link dropdown-toggle"
			href="../index.html"
			id="dLabelGlobalToc"
			role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		Site
	</a>
	<ul class="globaltoc" aria-labelledby="dLabelGlobalToc">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libmod/libmod.html">2. libMØD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pymod/pymod.html">3. PyMØD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postmod/postmod.html">4. PostMØD (<code class="docutils literal notranslate"><span class="pre">mod_post</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modWrapper/modWrapper.html">5. The Wrapper Script (<code class="docutils literal notranslate"><span class="pre">mod</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epim/epim.html">6. EpiM</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. Data Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dgStrat/dgStrat.html">8. Derivation Graph Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">9. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knownIssues.html">10. Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">11. Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">12. References</a></li>
</ul>

	</ul>
</li>
					
						<li class="nav-item dropdown localtoc-container">
	<a class="nav-link dropdown-toggle"
			href="../index.html"
			id="dLabelLocalToc"
			role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		Page
	</a>
	<ul class="localtoc" aria-labelledby="dLabelLocalToc">
		<ul>
<li><a class="reference internal" href="#">7. Data Formats</a><ul>
<li><a class="reference internal" href="#gml">7.1. GML</a><ul>
<li><a class="reference internal" href="#graph">7.1.1. Graph</a></li>
<li><a class="reference internal" href="#rule">7.1.2. Rule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tikz-rule">7.2. Tikz (Rule)</a></li>
<li><a class="reference internal" href="#dot-rule">7.3. DOT (Rule)</a></li>
<li><a class="reference internal" href="#tikz-graph">7.4. Tikz (Graph)</a></li>
<li><a class="reference internal" href="#dot-graph">7.5. DOT (Graph)</a></li>
<li><a class="reference internal" href="#smiles">7.6. SMILES</a><ul>
<li><a class="reference internal" href="#implicit-hydrogen-atoms">7.6.1. Implicit Hydrogen Atoms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphdfs">7.7. GraphDFS</a><ul>
<li><a class="reference internal" href="#grammar">7.7.1. Grammar</a></li>
<li><a class="reference internal" href="#semantics">7.7.2. Semantics</a></li>
<li><a class="reference internal" href="#abstracted-molecules">7.7.3. Abstracted Molecules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#molecule-encoding">7.8. Molecule Encoding</a><ul>
<li><a class="reference internal" href="#edges-bonds">7.8.1. Edges / Bonds</a></li>
<li><a class="reference internal" href="#vertices-atoms">7.8.2. Vertices / Atoms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#first-order-terms">7.9. First-Order Terms</a></li>
<li><a class="reference internal" href="#abstract-derivation-graphs">7.10. Abstract Derivation Graphs</a></li>
</ul>
</li>
</ul>

	</ul>
</li>
					
				
				
					
						
	<li class="nav-item">
		<a class="nav-link" href="../epim/epim.html" title="Previous Chapter: 6. EpiM">
			<span class="glyphicon glyphicon-chevron-left visible-sm"></span>
			<span class="hidden-sm hidden-tablet">
				&laquo; 6. EpiM
			</span>
		</a>
	</li>
	<li class="nav-item">
		<a class="nav-link" href="../dgStrat/dgStrat.html" title="Next Chapter: 8. Derivation Graph Strategies">
			<span class="glyphicon glyphicon-chevron-right visible-sm"></span>
			<span class="hidden-sm hidden-tablet">8. Derivation... &raquo;</span>
		</a>
	</li>
					
				
				
				
				
			</ul>
			
				
<form class="form-inline" action="../search.html" method="get">
	<div class="form-group">
		<input type="text" name="q" class="form-control" placeholder="Search" />
	</div>
	<input type="hidden" name="check_keywords" value="yes" />
	<input type="hidden" name="area" value="default" />
</form>
			
		</div>
	</div>
</nav>
<div class="container">
	<div class="row">
		<div class="body col-md-12 content" role="main">
			
  <div class="section" id="data-formats">
<h1><span class="section-number">7. </span>Data Formats<a class="headerlink" href="#data-formats" title="Permalink to this headline">¶</a></h1>
<p>MØD utilises several data formats and encoding schemes.</p>
<div class="section" id="gml">
<span id="id1"></span><h2><span class="section-number">7.1. </span>GML<a class="headerlink" href="#gml" title="Permalink to this headline">¶</a></h2>
<p>MØD uses the Graph Modelling Language (GML) for general specification of graphs
and rules.
The parser recognises most of the published <a class="reference external" href="http://www.fim.uni-passau.de/fileadmin/files/lehrstuhl/brandenburg/projekte/gml/gml-technical-report.pdf">specification</a>,
with regard to syntax. The specific grammar is as follows.</p>
<pre>
<strong id="grammar-token-gml-GML"><span id="grammar-token-gml"></span>GML       </strong> ::=  (<a class="reference internal" href="#grammar-token-gml-key"><code class="xref docutils literal notranslate"><span class="pre">key</span></code></a> <a class="reference internal" href="#grammar-token-gml-value"><code class="xref docutils literal notranslate"><span class="pre">value</span></code></a>)*
<strong id="grammar-token-gml-key"><span id="grammar-token-key"></span>key       </strong> ::=  <a class="reference internal" href="#grammar-token-gml-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token-gml-value"><span id="grammar-token-value"></span>value     </strong> ::=  int
                float
                quoteEscapedString
                <a class="reference internal" href="#grammar-token-gml-list"><code class="xref docutils literal notranslate"><span class="pre">list</span></code></a>
<strong id="grammar-token-gml-list"><span id="grammar-token-list"></span>list      </strong> ::=  '[' (<a class="reference internal" href="#grammar-token-gml-key"><code class="xref docutils literal notranslate"><span class="pre">key</span></code></a> <a class="reference internal" href="#grammar-token-gml-value"><code class="xref docutils literal notranslate"><span class="pre">value</span></code></a>)* ']'
<strong id="grammar-token-gml-identifier"><span id="grammar-token-identifier"></span>identifier</strong> ::=  a word matching the regex &quot;[a-zA-Z][a-zA-Z0-9]*&quot;
</pre>
<p>A <code class="docutils literal notranslate"><span class="pre">quoteEscapedString</span></code> is zero or more characters surrounded by double
quotation marks.  To include a <code class="docutils literal notranslate"><span class="pre">\&quot;</span></code> character it must be escaped.  Tabs,
newlines, and backslashses can be written as <code class="docutils literal notranslate"><span class="pre">\t</span></code>, <code class="docutils literal notranslate"><span class="pre">\n</span></code>, and <code class="docutils literal notranslate"><span class="pre">\\</span></code>.
GML code may have line comments, starting with <code class="docutils literal notranslate"><span class="pre">#</span></code>.
They are ignored during parsing.</p>
<div class="section" id="graph">
<span id="graph-gml"></span><h3><span class="section-number">7.1.1. </span>Graph<a class="headerlink" href="#graph" title="Permalink to this headline">¶</a></h3>
<p>A graph can be specified as <a class="reference internal" href="#gml"><span class="std std-ref">GML</span></a> by giving a list of vertices and edges
with the key <code class="docutils literal notranslate"><span class="pre">graph</span></code>.
The following grammar exemplifies the required key-value structure.</p>
<pre>
<strong id="grammar-token-gml-graphGML"><span id="grammar-token-graphgml"></span>graphGML</strong> ::=  'graph [' (<a class="reference internal" href="#grammar-token-gml-node"><code class="xref docutils literal notranslate"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-gml-edge"><code class="xref docutils literal notranslate"><span class="pre">edge</span></code></a>)* ']'
<strong id="grammar-token-gml-node"><span id="grammar-token-node"></span>node    </strong> ::=  'node [ id' int 'label' quoteEscapedString ']'
<strong id="grammar-token-gml-edge"><span id="grammar-token-edge"></span>edge    </strong> ::=  'edge [ source' int 'target' int 'label' quoteEscapedString ']'
</pre>
<p>Note though that list elements can appear in any order.</p>
</div>
<div class="section" id="rule">
<span id="rule-gml"></span><h3><span class="section-number">7.1.2. </span>Rule<a class="headerlink" href="#rule" title="Permalink to this headline">¶</a></h3>
<p>A rule <span class="math notranslate nohighlight">\((L\leftarrow K\rightarrow R)\)</span> in <a class="reference internal" href="#gml"><span class="std std-ref">GML</span></a> format is specified
as three graph fragments; <code class="docutils literal notranslate"><span class="pre">left</span></code>, <code class="docutils literal notranslate"><span class="pre">context</span></code>, and <code class="docutils literal notranslate"><span class="pre">right</span></code>.
From those
<span class="math notranslate nohighlight">\(L\)</span> is constructed as <code class="docutils literal notranslate"><span class="pre">left</span></code> <span class="math notranslate nohighlight">\(\cup\)</span> <code class="docutils literal notranslate"><span class="pre">context</span></code>,
<span class="math notranslate nohighlight">\(R\)</span> as <code class="docutils literal notranslate"><span class="pre">right</span></code> <span class="math notranslate nohighlight">\(\cup\)</span> <code class="docutils literal notranslate"><span class="pre">context</span></code>, and
<span class="math notranslate nohighlight">\(K\)</span> as <code class="docutils literal notranslate"><span class="pre">context</span></code> <span class="math notranslate nohighlight">\(\cup\)</span> (<code class="docutils literal notranslate"><span class="pre">left</span></code> <span class="math notranslate nohighlight">\(\cap\)</span> <code class="docutils literal notranslate"><span class="pre">right</span></code>).
Each graph fragment is specified as a list of vertices and edges, similar to a
graph in GML format.
The key-value structure is exemplified by the following grammar.</p>
<pre>
<strong id="grammar-token-gml-ruleGML"><span id="grammar-token-rulegml"></span>ruleGML        </strong> ::=  'rule ['
                        [ 'ruleID' quoteEscapedString ]
                        [ 'labelType &quot;' <a class="reference internal" href="#grammar-token-gml-labelType"><code class="xref docutils literal notranslate"><span class="pre">labelType</span></code></a> '&quot;' ]
                        [ <a class="reference internal" href="#grammar-token-gml-leftSide"><code class="xref docutils literal notranslate"><span class="pre">leftSide</span></code></a> ]
                        [ <a class="reference internal" href="#grammar-token-gml-context"><code class="xref docutils literal notranslate"><span class="pre">context</span></code></a> ]
                        [ <a class="reference internal" href="#grammar-token-gml-rightSide"><code class="xref docutils literal notranslate"><span class="pre">rightSide</span></code></a> ]
                        <a class="reference internal" href="#grammar-token-gml-matchConstraint"><code class="xref docutils literal notranslate"><span class="pre">matchConstraint</span></code></a>*
                     ']'
<strong id="grammar-token-gml-labelType"><span id="grammar-token-labeltype"></span>labelType      </strong> ::=  'string' | 'term'
<strong id="grammar-token-gml-leftSide"><span id="grammar-token-leftside"></span>leftSide       </strong> ::=  'left [' (<a class="reference internal" href="#grammar-token-gml-node"><code class="xref docutils literal notranslate"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-gml-edge"><code class="xref docutils literal notranslate"><span class="pre">edge</span></code></a>)* ']'
<strong id="grammar-token-gml-context"><span id="grammar-token-context"></span>context        </strong> ::=  'context [' (<a class="reference internal" href="#grammar-token-gml-node"><code class="xref docutils literal notranslate"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-gml-edge"><code class="xref docutils literal notranslate"><span class="pre">edge</span></code></a>)* ']'
<strong id="grammar-token-gml-rightSide"><span id="grammar-token-rightside"></span>rightSide      </strong> ::=  'right [' (<a class="reference internal" href="#grammar-token-gml-node"><code class="xref docutils literal notranslate"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-gml-edge"><code class="xref docutils literal notranslate"><span class="pre">edge</span></code></a>)* ']'
<strong id="grammar-token-gml-matchConstraint"><span id="grammar-token-matchconstraint"></span>matchConstraint</strong> ::=  <a class="reference internal" href="#grammar-token-gml-adjacency"><code class="xref docutils literal notranslate"><span class="pre">adjacency</span></code></a>
<strong id="grammar-token-gml-adjacency"><span id="grammar-token-adjacency"></span>adjacency      </strong> ::=  'constrainAdj ['
                        'id' int
                        'op &quot;' <a class="reference internal" href="#grammar-token-gml-op"><code class="xref docutils literal notranslate"><span class="pre">op</span></code></a> '&quot;'
                        'count' unsignedInt
                        [ 'nodeLabels [' <a class="reference internal" href="#grammar-token-gml-labelList"><code class="xref docutils literal notranslate"><span class="pre">labelList</span></code></a> ']' ]
                        [ 'edgeLabels [' <a class="reference internal" href="#grammar-token-gml-labelList"><code class="xref docutils literal notranslate"><span class="pre">labelList</span></code></a> ']' ]
                     ']'
<strong id="grammar-token-gml-labelList"><span id="grammar-token-labellist"></span>labelList      </strong> ::=  ('label' quoteEscapedString)*
<strong id="grammar-token-gml-op"><span id="grammar-token-op"></span>op             </strong> ::=  '&lt;' | '&lt;=' | '=' | '&gt;=' | '&gt;'
</pre>
<p>Note though that list elements can appear in any order.</p>
</div>
</div>
<div class="section" id="tikz-rule">
<span id="rule-tikz"></span><h2><span class="section-number">7.2. </span>Tikz (Rule)<a class="headerlink" href="#tikz-rule" title="Permalink to this headline">¶</a></h2>
<p>This format is used for visualising rules similarly to how the <a class="reference internal" href="#graph-tikz"><span class="std std-ref">Tikz (Graph)</span></a> format is used
for graphs. A rule is depicted as its span <span class="math notranslate nohighlight">\((L\leftarrow K\rightarrow R)\)</span> with the vertex
positions in the plane indicating the embedding of <span class="math notranslate nohighlight">\(K\)</span> in <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(R\)</span>.
Additionally, <span class="math notranslate nohighlight">\(L\backslash K\)</span> and <span class="math notranslate nohighlight">\(R\backslash K\)</span> are shown in different colour in
<span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(R\)</span> respectively.</p>
</div>
<div class="section" id="dot-rule">
<span id="rule-dot"></span><h2><span class="section-number">7.3. </span>DOT (Rule)<a class="headerlink" href="#dot-rule" title="Permalink to this headline">¶</a></h2>
<p>The DOT format (from <a class="reference external" href="http://www.graphviz.org">Graphviz</a>) is used for generating vertex coordinates for the Tikz format,
when <a class="reference external" href="http://openbabel.org">Open Babel</a> can not be used.</p>
</div>
<div class="section" id="tikz-graph">
<span id="graph-tikz"></span><h2><span class="section-number">7.4. </span>Tikz (Graph)<a class="headerlink" href="#tikz-graph" title="Permalink to this headline">¶</a></h2>
<p>Graphs are visualised using generated <a class="reference external" href="http://www.ctan.org/pkg/pgf">Tikz</a> code.
The coordinates for the layout is either generated using <a class="reference external" href="http://openbabel.org">Open Babel</a> or <a class="reference external" href="http://www.graphviz.org">Graphviz</a>.
The visualisation style is controlled by passing instances of the classes
<a class="reference internal" href="../libmod/graph/Printer.html#_CPPv4N3mod5graph7PrinterE" title="mod::graph::Printer"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">mod::graph::Printer</span></code></a> (C++) and <a class="reference internal" href="../pymod/graph/Printer.html#mod.GraphPrinter" title="mod.GraphPrinter"><code class="xref py py-class docutils literal notranslate"><span class="pre">mod.GraphPrinter</span></code></a> (Python)
to the printing functions.
The drawing style is inspired by <a class="reference external" href="http://www.ctan.org/pkg/chemfig">ChemFig</a> and <a class="reference external" href="http://openbabel.org">Open Babel</a>.
See also <a class="reference internal" href="../postmod/postmod.html"><span class="doc">PostMØD (mod_post)</span></a>.</p>
</div>
<div class="section" id="dot-graph">
<span id="graph-dot"></span><h2><span class="section-number">7.5. </span>DOT (Graph)<a class="headerlink" href="#dot-graph" title="Permalink to this headline">¶</a></h2>
<p>The DOT format (from <a class="reference external" href="http://www.graphviz.org">Graphviz</a>) is used for generating vertex coordinates for the Tikz format,
when <a class="reference external" href="http://openbabel.org">Open Babel</a> can not be used.</p>
</div>
<div class="section" id="smiles">
<span id="graph-smiles"></span><h2><span class="section-number">7.6. </span>SMILES<a class="headerlink" href="#smiles" title="Permalink to this headline">¶</a></h2>
<p>The <cite>Simplified molecular-input line-entry system</cite> is a line notation for
molecules. MØD can load most SMILES strings, and converts them internally to
labelled graphs. For graphs that are sufficiently molecule-like, a SMILES
string can be generated. The generated strings are canonical in the sense that
the same version of MØD will print the same SMILES string for isomorphic
molecules.</p>
<p>The reading of SMILES strings is based on the <a class="reference external" href="http://www.opensmiles.org/">OpenSMILES</a> specification, but with the following
notes/changes.</p>
<ul class="simple">
<li><p>Only single SMILES strings are accepted, i.e., not multiple strings separated
by white-space.</p></li>
<li><p>The specical dot “bond” (<code class="docutils literal notranslate"><span class="pre">.</span></code>) is not allowed.</p></li>
<li><p>Up and down bonds are regarded as implicit bonds, i.e., they might represent
either a sngle bond or an aromatic bond. The stereo information is ignored.</p></li>
<li><p>Atom classes are (mostly) ignored. They can be used to specify unique IDs to
atoms.</p></li>
<li><p>Wildcard atoms (specified with <code class="docutils literal notranslate"><span class="pre">*</span></code>) are converted to vertices with label
<code class="docutils literal notranslate"><span class="pre">*</span></code>. When inside brakcets, only the hydrogen count and atom class is then
permitted.</p></li>
<li><p>Abstract vertex labels can be specified inside brakcets. The bracket must in
that case only contain the label and an optional class label.
The label must be a non-empty string without <code class="docutils literal notranslate"><span class="pre">:</span></code> and with balanced square
brackets.</p></li>
<li><p>Charges of magnitude 2 and 3 may be specified with repeated <code class="docutils literal notranslate"><span class="pre">-</span></code> and <code class="docutils literal notranslate"><span class="pre">+</span></code>.</p></li>
<li><p>The bond type <code class="docutils literal notranslate"><span class="pre">$</span></code> is currently not allowed.</p></li>
<li><p>Aromaticity can only be specified using the bond type <code class="docutils literal notranslate"><span class="pre">:</span></code>
or using the special lower case atoms.
I.e., <code class="docutils literal notranslate"><span class="pre">c1ccccc1</span></code> and <code class="docutils literal notranslate"><span class="pre">C1:C:C:C:C:C:1</span></code> represent the same molecule,
but <code class="docutils literal notranslate"><span class="pre">C1=CC=CC=C1</span></code> is a different molecule.</p></li>
<li><p>Ring-bonds and branches may appear in mixed order. The normal order is to have
all ring-bonds first and all branches, e.g., <code class="docutils literal notranslate"><span class="pre">C123(O)(N)</span></code>.
The parser accepts them in mixed order, e.g., <code class="docutils literal notranslate"><span class="pre">C1(O)2(N)3</span></code>.</p></li>
<li><p>The final graph will conform to the molecule encoding scheme described below.</p></li>
<li><p>Implicit hydrogens are added following a more complicated procedure.</p></li>
<li><p>A bracketed atom can have a radical by writing a dot (<code class="docutils literal notranslate"><span class="pre">.</span></code>) between the
position of the charge and the position of the class.</p></li>
</ul>
<p>The written SMILES strings are intended to be canonical and may not conform to any “prettyness” standards.</p>
<div class="section" id="implicit-hydrogen-atoms">
<h3><span class="section-number">7.6.1. </span>Implicit Hydrogen Atoms<a class="headerlink" href="#implicit-hydrogen-atoms" title="Permalink to this headline">¶</a></h3>
<p>When SMILES strings are written they will use implicit hydrogens whenever they
can be inferred when reading the string.
For the purposes of implicit hydrogens we use the following definition of
valence for an atom.
The valence of an atom is the weighted sum of its incident edges, where single
(<code class="docutils literal notranslate"><span class="pre">-</span></code>) and aromatic (<code class="docutils literal notranslate"><span class="pre">:</span></code>) bonds have weight 1, double bounds (<code class="docutils literal notranslate"><span class="pre">=</span></code>) have
weight 2, and triple bonds (<code class="docutils literal notranslate"><span class="pre">#</span></code>) have weight 3.
If an atom has an incident aromatic bond, its valence is increased by 1.
The atoms that can have implicit hydrogens are B, C, N, O, P, S, F, Cl, Br, and I.
Each have a set of so-called “normal” valences as shown in the following table.
The atoms N and S additionally have certain sets of incident edges that are
also considered “normal”, which are also listed in the table.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Atom</p></th>
<th class="head"><p>Normal Valences and Neighbourhoods</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>B</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>N</p></td>
<td><p>3, 5, <span class="math notranslate nohighlight">\(\{-, :, :\}\)</span>, <span class="math notranslate nohighlight">\(\{-, -, =\}\)</span>, <span class="math notranslate nohighlight">\(\{:, :, :\}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>O</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>P</p></td>
<td><p>3, 5</p></td>
</tr>
<tr class="row-odd"><td><p>S</p></td>
<td><p>2, 4, 6, <span class="math notranslate nohighlight">\(\{:, :\}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>F, Cl, Br, I</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>If the set of incident edges is listed in the table, then no hydrogens are added.
If the valence is higher than the highest normal valence, then no hydrogens are
added.
Otherwise, hydrogens are added until the valence is at the next higher normal
valence.</p>
<p>When writing SMILES strings the inverse procedure is used.</p>
</div>
</div>
<div class="section" id="graphdfs">
<span id="graph-graphdfs"></span><h2><span class="section-number">7.7. </span>GraphDFS<a class="headerlink" href="#graphdfs" title="Permalink to this headline">¶</a></h2>
<p>The GraphDFS format is intended to provide a convenient line notation for
general undirected labelled graphs. Thus it is in many aspects similar to
SMILES strings, but a string being both a valid SMILES string and GraphDFS
string <strong>may not represent the same graph</strong>.
The semantics of ring-closures/back-edges are in particular not the same.</p>
<div class="section" id="grammar">
<h3><span class="section-number">7.7.1. </span>Grammar<a class="headerlink" href="#grammar" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-graphDFS-graphDFS"><span id="grammar-token-graphdfs"></span>graphDFS                    </strong> ::=  <a class="reference internal" href="#grammar-token-graphDFS-chain"><code class="xref docutils literal notranslate"><span class="pre">chain</span></code></a>
<strong id="grammar-token-graphDFS-chain"><span id="grammar-token-chain"></span>chain                       </strong> ::=  <a class="reference internal" href="#grammar-token-graphDFS-vertex"><code class="xref docutils literal notranslate"><span class="pre">vertex</span></code></a> <a class="reference internal" href="#grammar-token-graphDFS-evPair"><code class="xref docutils literal notranslate"><span class="pre">evPair</span></code></a>*
<strong id="grammar-token-graphDFS-vertex"><span id="grammar-token-vertex"></span>vertex                      </strong> ::=  (<a class="reference internal" href="#grammar-token-graphDFS-labelVertex"><code class="xref docutils literal notranslate"><span class="pre">labelVertex</span></code></a> | <a class="reference internal" href="#grammar-token-graphDFS-ringClosure"><code class="xref docutils literal notranslate"><span class="pre">ringClosure</span></code></a>) <a class="reference internal" href="#grammar-token-graphDFS-branch"><code class="xref docutils literal notranslate"><span class="pre">branch</span></code></a>*
<strong id="grammar-token-graphDFS-evPair"><span id="grammar-token-evpair"></span>evPair                      </strong> ::=  <a class="reference internal" href="#grammar-token-graphDFS-edge"><code class="xref docutils literal notranslate"><span class="pre">edge</span></code></a> <a class="reference internal" href="#grammar-token-graphDFS-vertex"><code class="xref docutils literal notranslate"><span class="pre">vertex</span></code></a>
<strong id="grammar-token-graphDFS-labelVertex"><span id="grammar-token-labelvertex"></span>labelVertex                 </strong> ::=  '[' bracketEscapedString ']' [ <a class="reference internal" href="#grammar-token-graphDFS-defRingId"><code class="xref docutils literal notranslate"><span class="pre">defRingId</span></code></a> ]
                                  <a class="reference internal" href="#grammar-token-graphDFS-implicitHydrogenVertexLabels"><code class="xref docutils literal notranslate"><span class="pre">implicitHydrogenVertexLabels</span></code></a> [ <a class="reference internal" href="#grammar-token-graphDFS-defRingId"><code class="xref docutils literal notranslate"><span class="pre">defRingId</span></code></a> ]
<strong id="grammar-token-graphDFS-implicitHydrogenVertexLabels"><span id="grammar-token-implicithydrogenvertexlabels"></span>implicitHydrogenVertexLabels</strong> ::=  'B' | 'C' | 'N' | 'O' | 'P' | 'S' | 'F' | 'Cl' | 'Br' | 'I'
<strong id="grammar-token-graphDFS-defRingId"><span id="grammar-token-defringid"></span>defRingId                   </strong> ::=  unsignedInt
<strong id="grammar-token-graphDFS-ringClosure"><span id="grammar-token-ringclosure"></span>ringClosure                 </strong> ::=  unsignedInt
<strong id="grammar-token-graphDFS-edge">edge                        </strong> ::=  '{' braceEscapedString '}'
                                  <a class="reference internal" href="#grammar-token-graphDFS-shorthandEdgeLabels"><code class="xref docutils literal notranslate"><span class="pre">shorthandEdgeLabels</span></code></a>
<strong id="grammar-token-graphDFS-shorthandEdgeLabels"><span id="grammar-token-shorthandedgelabels"></span>shorthandEdgeLabels         </strong> ::=  '-' | ':' | '=' | '#' | ''
<strong id="grammar-token-graphDFS-branch"><span id="grammar-token-branch"></span>branch                      </strong> ::=  '(' <a class="reference internal" href="#grammar-token-graphDFS-evPair"><code class="xref docutils literal notranslate"><span class="pre">evPair</span></code></a>+ ')'
</pre>
<p>A <code class="docutils literal notranslate"><span class="pre">bracketEscapedString</span></code> and <code class="docutils literal notranslate"><span class="pre">braceEscapedString</span></code> are zero or more
characters except respectively <code class="docutils literal notranslate"><span class="pre">]</span></code> and <code class="docutils literal notranslate"><span class="pre">}</span></code>. To have these characters in
each of their strings they must be escaped, i.e., <code class="docutils literal notranslate"><span class="pre">\]</span></code> and <code class="docutils literal notranslate"><span class="pre">\}</span></code>
respectively.</p>
<p>The parser additionally enforces that a <a class="reference internal" href="#grammar-token-graphDFS-defRingId"><code class="xref std std-token docutils literal notranslate"><span class="pre">defRingId</span></code></a> may not be
a number which has previously been used.
Similarly, a <a class="reference internal" href="#grammar-token-graphDFS-ringClosure"><code class="xref std std-token docutils literal notranslate"><span class="pre">ringClosure</span></code></a> may only be a number which has
previously occured in a <a class="reference internal" href="#grammar-token-graphDFS-defRingId"><code class="xref std std-token docutils literal notranslate"><span class="pre">defRingId</span></code></a>.</p>
<p>A vertex specified via the <a class="reference internal" href="#grammar-token-graphDFS-implicitHydrogenVertexLabels"><code class="xref std std-token docutils literal notranslate"><span class="pre">implicitHydrogenVertexLabels</span></code></a> rule
will potentially have ekstra neighbours added after parsning. The rules are the
exact same as for implicit hydrogen atoms in <a class="reference internal" href="#graph-smiles"><span class="std std-ref">SMILES</span></a>.</p>
</div>
<div class="section" id="semantics">
<h3><span class="section-number">7.7.2. </span>Semantics<a class="headerlink" href="#semantics" title="Permalink to this headline">¶</a></h3>
<p>A GraphDFS string is, like the SMILES strings, an encoding of a depth-first traversal of the
graph it encodes.
Vertex labels are enclosed in square brackets and edge labels are enclosed in curly brackets.
However, a special set of labels can be specified without the enclosing brackets.
An edge label may additionally be completely omitted as a shorthand for a dash (<code class="docutils literal notranslate"><span class="pre">-</span></code>).</p>
<p>A vertex can have a numeric identifier, defined by the
<a class="reference internal" href="#grammar-token-graphDFS-defRingId"><code class="xref std std-token docutils literal notranslate"><span class="pre">defRingId</span></code></a> non-terminal.
At a later stage this identifier can be used as a vertex specification to
specify a back-edge in the depth-first traversal.
Example: <code class="docutils literal notranslate"><span class="pre">[v1]1-[v2]-[v3]-[v4]-1</span></code>, specifies a labelled <span class="math notranslate nohighlight">\(C_3\)</span>
(which equivalently can be specified shorter as <code class="docutils literal notranslate"><span class="pre">[v1]1[v2][v3][v4]1</span></code>).</p>
<p>A <a class="reference internal" href="#grammar-token-graphDFS-vertex"><code class="xref std std-token docutils literal notranslate"><span class="pre">vertex</span></code></a> being a <a class="reference internal" href="#grammar-token-graphDFS-ringClosure"><code class="xref std std-token docutils literal notranslate"><span class="pre">ringClosure</span></code></a> can never be
the first vertex in a string, and is thus preceded with a
<a class="reference internal" href="#grammar-token-graphDFS-edge"><code class="xref std std-token docutils literal notranslate"><span class="pre">edge</span></code></a>. As in a depth-first traversal, such a back-edge is a
kind of degenerated branch. Example: <code class="docutils literal notranslate"><span class="pre">[v1]1[v2][v3][v4]1[v5][v6]1</span></code>, this
specifies a graph which is two fused <span class="math notranslate nohighlight">\(C_4\)</span> with a common edge (and not
just a common vertex).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The semantics of back-edges/ring closures are <strong>not</strong> the same as in SMILES strings.
In SMILES, a pair of matching numeric identifiers denote the individual back-edges.</p>
</div>
<p>A branch in the depth-first traversal is enclosed in parentheses.</p>
</div>
<div class="section" id="abstracted-molecules">
<h3><span class="section-number">7.7.3. </span>Abstracted Molecules<a class="headerlink" href="#abstracted-molecules" title="Permalink to this headline">¶</a></h3>
<p>The short-hand labels for vertices and edges makes it easier to specify partial molecules
than using <a class="reference internal" href="#graph-gml"><span class="std std-ref">GML</span></a> files.</p>
<p>As example, consider modelling Acetyl-CoA in which we wish to abstract most of the CoA part.
The GraphDFS string <code class="docutils literal notranslate"><span class="pre">CC(=O)S[CoA]</span></code> can be used and we let the library add missing hydrogen
atoms to the vertices which encode atoms. A plain CoA molecule would in this modelling be
<code class="docutils literal notranslate"><span class="pre">[CoA]S</span></code>, or a bit more verbosely as <code class="docutils literal notranslate"><span class="pre">[CoA]S[H]</span></code>.</p>
<p>The format can also be used to create completely abstract structures
(it can encode any undirected labelled graph), e.g., RNA strings.
Note that in this case it may not be appropriate to add “missing” hydrogen atoms.
This can be controlled by an optional parameter to the loading function.</p>
</div>
</div>
<div class="section" id="molecule-encoding">
<span id="mol-enc"></span><h2><span class="section-number">7.8. </span>Molecule Encoding<a class="headerlink" href="#molecule-encoding" title="Permalink to this headline">¶</a></h2>
<p>There is no strict requirement that graphs encode molecules, however several optimizations
are in place when they do.
The following describes how to encode molecules as undirected, simple, labelled graphs and thus
when the library assumes a graph is a molecule.</p>
<div class="section" id="edges-bonds">
<h3><span class="section-number">7.8.1. </span>Edges / Bonds<a class="headerlink" href="#edges-bonds" title="Permalink to this headline">¶</a></h3>
<p>An edge encodes a chemical bond if and only if its label is listed in the table below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>Interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Single bond</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:</span></code></p></td>
<td><p>“Aromatic” bond</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">=</span></code></p></td>
<td><p>Double bond</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#</span></code></p></td>
<td><p>Triple bond</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="vertices-atoms">
<h3><span class="section-number">7.8.2. </span>Vertices / Atoms<a class="headerlink" href="#vertices-atoms" title="Permalink to this headline">¶</a></h3>
<p>A vertex encodes an atom with a charge if and only if its label conforms to the following grammar.</p>
<pre>
<strong id="grammar-token-molecularVertexLabel-vertexLabel"><span id="grammar-token-vertexlabel"></span>vertexLabel</strong> ::=  [ isotope ] <a class="reference internal" href="#grammar-token-molecularVertexLabel-atomSymbol"><code class="xref docutils literal notranslate"><span class="pre">atomSymbol</span></code></a> [ <a class="reference internal" href="#grammar-token-molecularVertexLabel-charge"><code class="xref docutils literal notranslate"><span class="pre">charge</span></code></a> ] [ <a class="reference internal" href="#grammar-token-molecularVertexLabel-radical"><code class="xref docutils literal notranslate"><span class="pre">radical</span></code></a> ]
<strong id="grammar-token-molecularVertexLabel-isotope"><span id="grammar-token-isotope"></span>isotope    </strong> ::=  unsignedInt
<strong id="grammar-token-molecularVertexLabel-charge"><span id="grammar-token-charge"></span>charge     </strong> ::=  singleDigit ('-' | '+')
<strong id="grammar-token-molecularVertexLabel-radical"><span id="grammar-token-radical"></span>radical    </strong> ::=  '.'
<strong id="grammar-token-molecularVertexLabel-atomSymbol"><span id="grammar-token-atomsymbol"></span>atomSymbol </strong> ::=  an atom symbol with the first letter capitalised
</pre>
<p>Currently there are no valence requirements for a graph being recognised as a
molecule.</p>
</div>
</div>
<div class="section" id="first-order-terms">
<span id="term-desc"></span><h2><span class="section-number">7.9. </span>First-Order Terms<a class="headerlink" href="#first-order-terms" title="Permalink to this headline">¶</a></h2>
<p>Vertex/edge labels on graphs/rules can be interpreted either as text strings
or as <a class="reference external" href="https://en.wikipedia.org/wiki/Unification_(computer_science)#First-order_term">firt-order terms</a>.
Additionally, for first-order terms there is a choice in which type of relation between terms
should be required in morphisms.
This can be controlled in each algorithm through label settings objects
(C++: <a class="reference internal" href="../libmod/Config.html#_CPPv4N3mod13LabelSettingsE" title="mod::LabelSettings"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">LabelSettings</span></code></a>, Python: <a class="reference internal" href="../pymod/Config.html#mod.LabelSettings" title="mod.LabelSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">LabelSettings</span></code></a>).</p>
<p>A constant or function symbol is a word that can be matched
by the regex <code class="docutils literal notranslate"><span class="pre">[A-Za-z0-9=#:.+-][A-Za-z0-9=#:.+-_]*</span></code>.
This means that all strings that are usually considered “molecular” can be reinterpreted
as constant symbols.</p>
<p>A variable symbol is a word that can be matched
by the regex <code class="docutils literal notranslate"><span class="pre">_[A-Za-z0-9=#:.+-][A-Za-z0-9=#:.+-_]*</span></code>.
That is, variable is like a constant/function symbol, but with a <code class="docutils literal notranslate"><span class="pre">_</span></code> prepended.
An unnamed variable can be specified by the special wildcard symbol <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Variable names matched by the regex <code class="docutils literal notranslate"><span class="pre">_[HT][0-9][0-9]*</span></code> may be generated
when printing out graphs/rules. Any original variable names are not saved.</p>
</div>
<p>Function terms start with a function symbol followed by
a parenthesis with a comma-separated list of terms.
They may contain white-space.</p>
<p>If parsing of terms fails a specific exception is thrown
(C++: <a class="reference internal" href="../libmod/Error.html#_CPPv4N3mod16TermParsingErrorE" title="mod::TermParsingError"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TermParsingError</span></code></a>, Python: <a class="reference internal" href="../pymod/Error.html#mod.TermParsingError" title="mod.TermParsingError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TermParsingError</span></code></a>).</p>
</div>
<div class="section" id="abstract-derivation-graphs">
<span id="dg-abstract-desc"></span><h2><span class="section-number">7.10. </span>Abstract Derivation Graphs<a class="headerlink" href="#abstract-derivation-graphs" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is really convenient to quickly write down a few equations to
describe a “derivation graph”, without associating actual graphs and rules to
it. That is, only specifying the underlying network.
The network description is a string adhering to the following grammar:</p>
<pre>
<strong id="grammar-token-dgAbstract-description"><span id="grammar-token-description"></span>description</strong> ::=  <a class="reference internal" href="#grammar-token-dgAbstract-derivation"><code class="xref docutils literal notranslate"><span class="pre">derivation</span></code></a> { <a class="reference internal" href="#grammar-token-dgAbstract-derivation"><code class="xref docutils literal notranslate"><span class="pre">derivation</span></code></a> }
<strong id="grammar-token-dgAbstract-derivation"><span id="grammar-token-derivation"></span>derivation </strong> ::=  <a class="reference internal" href="#grammar-token-dgAbstract-side"><code class="xref docutils literal notranslate"><span class="pre">side</span></code></a> (&quot;-&gt;&quot; | &quot;&lt;=&gt;&quot;) <a class="reference internal" href="#grammar-token-dgAbstract-side"><code class="xref docutils literal notranslate"><span class="pre">side</span></code></a>
<strong id="grammar-token-dgAbstract-side"><span id="grammar-token-side"></span>side       </strong> ::=  <a class="reference internal" href="#grammar-token-dgAbstract-term"><code class="xref docutils literal notranslate"><span class="pre">term</span></code></a> { &quot;+&quot; <a class="reference internal" href="#grammar-token-dgAbstract-term"><code class="xref docutils literal notranslate"><span class="pre">term</span></code></a> }
<strong id="grammar-token-dgAbstract-term"><span id="grammar-token-term"></span>term       </strong> ::=  [ unsignedInt ] <a class="reference internal" href="#grammar-token-dgAbstract-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token-dgAbstract-identifier">identifier </strong> ::=  any character sequence without spaces
</pre>
<p>Note that the <a class="reference internal" href="#grammar-token-dgAbstract-identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">identifier</span></code></a> definition
in particular means that whitespace is important between coefficients and
identifiers. E.g., <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">A</span> <span class="pre">-&gt;</span> <span class="pre">B</span></code> is different from <code class="docutils literal notranslate"><span class="pre">2A</span> <span class="pre">-&gt;</span> <span class="pre">B</span></code>.</p>
<p>See also <a class="reference internal" href="../pymod/dg/Builder.html#mod.DGBuilder.addAbstract" title="mod.DGBuilder.addAbstract"><code class="xref py py-func docutils literal notranslate"><span class="pre">DGBuilder.addAbstract()</span></code></a>/<a class="reference internal" href="../libmod/dg/Builder.html#_CPPv4N3mod2dg7Builder11addAbstractERKNSt6stringE" title="mod::dg::Builder::addAbstract"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">dg::Builder::addAbstract()</span></code></a>.</p>
</div>
</div>


		</div>
		  
	</div>
</div>
<footer class="footer"><div class="container"><div class="row">
	<div class="col-auto mr-auto">
		<p>
					&copy; Copyright 2013-2020, Jakob Lykke Andersen.<br/>
				Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.0+/a8927bcd3.<br/>
		</p>
	</div>
	<div class="col-auto">
		<a href="#">Back to top</a>
		
			<br/>
			
	<div id="sourcelink">
		<a href="../_sources/dataDesc/dataDesc.rst.txt"
			 rel="nofollow">Source</a>
	</div>
		
	</div>
</div></div></footer>
  </body>
</html>